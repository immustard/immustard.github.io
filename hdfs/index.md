# Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿâ€”â€”HDFS


<!--more-->

## ä»‹ç»

**HDFS (Hadoop Distributed File System)** æ˜¯ Hadoopä¸‹çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ, å…·æœ‰é«˜å®¹é”™ã€é«˜ååé‡ç­‰ç‰¹æ€§, å¯ä»¥éƒ¨ç½²åœ¨ä½æˆæœ¬çš„ç¡¬ä»¶ä¸Š. 



## è®¾è®¡åŸç†

### æ¶æ„

HDFS éµä»ä¸»/ä»æ¶æ„, ç”±**å•ä¸ª** NameNode(NN) å’Œ **å¤šä¸ª** DataNote(DN) ç»„æˆ:

* **NameNode**: è´Ÿè´£æ‰§è¡Œæœ‰å…³`æ–‡ä»¶ç³»ç»Ÿå‘½åç©ºé—´`çš„æ“ä½œ, ğŸŒ°: æ‰“å¼€, å…³é—­ã€é‡å‘½åæ–‡ä»¶å’Œç›®å½•ç­‰. åŒäº‹è¿˜è´Ÿè´£é›†ç¾¤å…ƒæ•°æ®çš„å­˜å‚¨, è®°å½•ç€æ–‡ä»¶ä¸­å„ä¸ªæ•°æ®å—çš„ä½ç½®ä¿¡æ¯. 

  > ä¹Ÿå°±æ˜¯è¯´ä¸»è¦æ˜¯ç”¨æ¥å­˜å‚¨å…ƒæ•°æ®çš„. 

* **DataNode**: è´Ÿè´£æä¾›æ¥è‡ªæ–‡ä»¶ç³»ç»Ÿå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚, æ‰§è¡Œå—çš„åˆ›å»º, åˆ é™¤ç­‰æ“ä½œ. 

  > ç”¨æ¥å­˜å‚¨å…·ä½“æ–‡ä»¶çš„. 



### æ–‡ä»¶ç³»ç»Ÿå‘½åç©ºé—´

HDFS çš„`æ–‡ä»¶ç³»ç»Ÿå‘½åç©ºé—´`çš„å±‚æ¬¡ç»“æ„ä¸å¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿç±»ä¼¼(ğŸŒ°: Linux), æ”¯æŒç›®å½•å’Œæ–‡ä»¶çš„åˆ›å»ºã€ç§»åŠ¨ã€åˆ é™¤å’Œé‡å‘½åç­‰æ“ä½œ, æ”¯æŒé…ç½®ç”¨æˆ·å’Œè®¿é—®æƒé™, **ä½†ä¸æ”¯æŒç¡¬é“¾æ¥å’Œè½¯è¿æ¥**. `NameNode`è´Ÿè´£ç»´æŠ¤æ–‡ä»¶ç³»ç»Ÿåç§°ç©ºé—´, è®°å½•å¯¹åç§°ç©ºé—´æˆ–å…¶å±æ€§çš„ä»»ä½•æ›´æ”¹. 

 

### æ•°æ®å¤åˆ¶

ç”±äº Hadoop æ˜¯è¢«è®¾è®¡è¿è¡Œåœ¨å»‰ä»·çš„æœºå™¨ä¸Šçš„, è¿™å°±ä¸€ä½ç½®ç¡¬ä»¶å…¶å®æ˜¯ä¸å¯é çš„. æ‰€ä»¥ä¸ºäº†ä¿è¯é«˜å®¹é”™, HDFS æä¾›äº†**æ•°æ®å¤åˆ¶**æœºåˆ¶. HDFS å°†æ¯ä¸ªæ–‡ä»¶å­˜å‚¨ä¸ºä¸€ç³»åˆ—**å—**, æ¯ä¸ªå—ç”±å¤šä¸ªå‰¯æœ¬æ¥ä¿è¯å®¹é”™, å—çš„å¤§å°å’Œå¤åˆ¶å› å­å¯é…ç½® (é»˜è®¤ä¸‹, å—ä¸º128M, å¤åˆ¶å› å­ä¸º3). 



#### æ•°æ®å¤åˆ¶çš„å®ç°åŸç†

å¤§å‹çš„ HDFS å®ä¾‹é€šå¸¸åˆ†å¸ƒåœ¨å¤šä¸ªæœºæ¶çš„å¤šå°æœåŠ¡å™¨ä¸Š, ä¸åŒæœºæ¶ä¸Šçš„ä¸¤å°æœåŠ¡å™¨ä¹‹é—´é€šè¿‡äº¤æ¢æœºè¿›è¡Œé€šè®¯. å¤§å¤šæ•°æƒ…å†µä¸‹, åŒä¸€æœºæ¶ä¸­çš„æœåŠ¡æœŸé—´çš„ç½‘ç»œå¸¦å®½å¤§äºä¸åŒæœºæ¶ä¸­çš„æœåŠ¡å™¨ä¹‹é—´çš„å¸¦å®½. æ‰€ä»¥, HDFS é‡‡ç”¨**æœºæ¶æ„ŸçŸ¥å‰¯æœ¬æ”¾ç½®ç­–ç•¥**. 



ğŸŒ°, å¯¹äºé»˜è®¤æƒ…å†µ, å½“å¤åˆ¶å› å­ä¸º3æ—¶, HDFS çš„æ”¾ç½®ç­–ç•¥æ˜¯:

åœ¨å†™å…¥ç¨‹åºä½äº `DN` ä¸Šæ—¶, å°±ä¼˜å…ˆå°†å†™å…¥æ–‡ä»¶çš„ä¸€ä¸ªå‰¯æœ¬æ”¾ç½®åœ¨è¯¥ `DN` ä¸Š, å¦åˆ™æ”¾åœ¨**éšæœº** `DN` ä¸Š. ä¹‹åå¦ä¸€ä¸ªè¿œç¨‹æœºæ¶ä¸Šçš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ”¾ç½®å¦ä¸€ä¸ªå‰¯æœ¬, å¹¶åœ¨è¯¥æœºåŠ ä¸Šçš„å¦ä¸€ä¸ªèŠ‚ç‚¹æ”¾ç½®æœ€åä¸€ä¸ªå‰¯æœ¬. è¿™ä¹ˆåšçš„å¥½å¤„å°±æ˜¯å¯ä»¥å‡å°‘æœºæ¶é—´çš„å†™å…¥æµé‡, ä»è€Œæé«˜å†™å…¥æ€§èƒ½. 



å¦‚æœå¤åˆ¶å› å­å¤§äº3, åˆ™éšæœºç¡®å®šç¬¬4ä¸ªå’Œä¹‹åå‰¯æœ¬çš„æ”¾ç½®ä½ç½®, åŒæ—¶éœ€è¦ä¿æŒæ¯ä¸ªæœºæ¶çš„å‰¯æœ¬æ•°é‡ä½äºä¸Šé™, ä¸Šé™å€¼é€šå¸¸ä¸º `(å¤åˆ¶ç³»æ•° - 1)/æœºæ¶æ•° + 2`. 

**æ³¨æ„**: ä¸å…è®¸åŒä¸€ä¸ª `DN` ä¸Šå…·æœ‰åŒä¸€å—çš„ç›¸åŒå‰¯æœ¬. æ¯ä¸ªæœºæ¶æœ€å¤šå­˜å‚¨ä¸¤ä»½å¤‡ä»½. ä½†æ˜¯åœ¨è¿™ä¸¤ä¸ªæ¡ä»¶æ— æ³•è¢«æ»¡è¶³çš„ä¸€äº›æƒ…å†µä¸‹, è¿™äº›æ¡ä»¶ä¼šè¢«å¿½ç•¥. å¹¶ä¸” HDFS å…è®¸è‡ªå®šä¹‰å¸ƒå±€ç®—æ³•. 



#### å‰¯æœ¬çš„é€‰æ‹©

å‰¯æœ¬çš„é€‰æ‹©ä¸ºäº†æœ€å¤§é™åº¦åœ°å‡å°‘å¸¦å®½æ¶ˆè€—å’Œè¯»å–å»¶è¿Ÿ, HDFS åœ¨æ‰§è¡Œè¯»å–è¯·æ±‚æ—¶, ä¼˜å…ˆè¯»å–è·ç¦»è¯»å–å…¶æœ€è¿‘çš„å‰¯æœ¬(ç‰©ç†å±‚é¢ä¸Š). ä¹Ÿå°±æ˜¯è¯´, å¦‚æœä¸è¯»å–å™¨èŠ‚ç‚¹ç›¸åŒçš„æœºæ¶ä¸Šå­˜åœ¨å‰¯æœ¬, åˆ™ä¼˜å…ˆé€‰æ‹©è¯¥å‰¯æœ¬. å¦‚æœ HDFS é›†ç¾¤è·¨è¶Šå¤šä¸ªæ•°æ®ä¸­å¿ƒ, ä¼˜å…ˆé€‰æ‹©æœ¬åœ°æ•°æ®ä¸­å¿ƒä¸Šçš„å‰¯æœ¬. 



### æ¶æ„çš„ç¨³å®šæ€§

#### å¿ƒè·³æœºåˆ¶å’Œé‡æ–°å¤åˆ¶

æ¯ä¸ª `DN` å®šæœŸå‘ `NN` å‘é€å¿ƒè·³, å¦‚æœè¶…è¿‡æŒ‡å®šæ—¶é—´æ²¡æœ‰æ”¶åˆ°å¿ƒè·³, ä¼šå°†è¯¥ `DN` æ ‡è®°ä¸ºå·²æ­»äº¡. `NN` ä¸ä¼šå°†ä»»ä½•æ–°çš„ IOè¯·æ±‚ è½¬å‘ç»™æ ‡è®°ä¸ºæ­»äº¡çš„ `DN`, ä¹Ÿä¸ä¼šå†ä½¿ç”¨å·²æ­»äº¡çš„ `DN` ä¸Šçš„æ•°æ®. 



`DN` ä¹Ÿä¼šå°†å…¶æ‰€æœ‰æ•°æ®å—åˆ—è¡¨å®šæ—¶å‘é€ç»™ `NN`, å¹¶ä¸”åœ¨å‘é€ä¹‹å‰ `DN` ä¼šæ£€æµ‹æ ¡éªŒå’Œæ˜¯å¦æ­£å¸¸, è‹¥ä¸æ­£å¸¸, åˆ™ä¸ä¼šå‘é€ç»™ `NN`. æ‰€ä»¥ `NN` ä¼šæ£€æµ‹å‡ºé‚£äº›æ•°æ®å—å·²ç»æŸå. 



ç”±äºæ•°æ®ä¸å†å¯ç”¨, å¯èƒ½ä¼šå¯¼è‡´æŸäº›å—å‰¯æœ¬æ•°å°äºå¤åˆ¶å› å­, æ‰€ä»¥ `NN` ä¼šè·Ÿè¸ªè¿™äº›å—, å¹¶åœ¨å¿…è¦çš„æ—¶å€™è¿›è¡Œé‡æ–°å¤åˆ¶. 



#### æ•°æ®çš„å®Œæ•´æ€§

ç”±äºå­˜å‚¨è®¾å¤‡æ•…éšœç­‰åŸå› , å­˜å‚¨åœ¨ `DN` ä¸Šçš„æ•°æ®å—ä¹Ÿä¼šå‘ç”ŸæŸå. ä¸ºäº†é¿å…è¯»å–åˆ°ä¸€æŸåçš„æ•°æ®è€Œå¯¼è‡´é”™è¯¯, HDFS æä¾›äº†æ•°æ®å®Œæ•´æ€§æœºåˆ¶æ¥ä¿å­˜æ•°æ®çš„å®Œæ•´æ€§:

å½“å®¢æˆ·ç«¯åˆ›å»º HDFS æ–‡ä»¶æ—¶,  å®ƒä¼šè®¡ç®—æ–‡ä»¶çš„æ¯ä¸ªå—çš„`æ ¡éªŒå’Œ`, å¹¶å°†`æ ¡éªŒå’Œ`å­˜å‚¨åœ¨åŒä¸€ HDFS å‘½åç©ºé—´ä¸‹çš„å•ç‹¬çš„éšè—æ–‡ä»¶ä¸­. å½“å®¢æˆ·ç«¯æ£€ç´¢æ–‡ä»¶å†…å®¹æ—¶, å®ƒä¼šæ ¡éªŒä»æ¯ä¸ª `DN` æ¥æ”¶çš„æ•°æ®æ˜¯å¦ä¸å­˜å‚¨åœ¨å…³è”æ ¡éªŒå’Œæ–‡ä»¶ä¸­çš„`æ ¡éªŒå’Œ`åŒ¹é…. å¦‚æœä¸åŒ¹é…, ä»£è¡¨æ•°æ®å·²ç»æŸå, è¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯ä¼šé€‰æ‹©å…¶ä»– `DN` è·å–å‰¯æœ¬, å¹¶é‡æ–°æ ¡éªŒ. 



#### å…ƒæ•°æ®çš„ç£ç›˜æ•…éšœ

`FsImage` å’Œ `EditLog` æ˜¯ HDFS çš„æ ¸å¿ƒæ•°æ®, è¿™äº›æ•°æ®çš„ä»¥ä¸ºä¸¢å¤±å¯èƒ½å¯¼è‡´æ•´ä¸ª HDFS æœåŠ¡ä¸å¯ç”¨. ä¸ºäº†é¿å…, å¯ä»¥é…ç½® `NN` ä½¿å…¶æ”¯æŒ `FsImage` å’Œ `EditLog` å¤šå‰¯æœ¬åŒæ­¥, è¿™æ · `FsImage` æˆ– `EditLog` çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¼•èµ·æ¯ä¸ªå‰¯æœ¬çš„åŒæ­¥æ›´æ–°. 



#### æ”¯æŒå¿«ç…§

å¿«ç…§æ”¯æŒåœ¨ç‰¹å®šæ—¶åˆ»å­˜å‚¨æ•°æ®å‰¯æœ¬, åœ¨æ•°æ®æ„å¤–æŸåæ—¶, å¯ä»¥é€šè¿‡å›æ»šæ“ä½œæ¢å¤åˆ°ç®€å†µçš„æ•°æ®çŠ¶æ€. 



## ç‰¹ç‚¹

1. é«˜å®¹é”™

   ä¸Šé¢å·²ç»ä»‹ç»äº† HDFS é‡‡ç”¨æ•°æ®çš„å¤šå‰¯æœ¬æ–¹æ¡ˆ, æ‰€ä»¥éƒ¨åˆ†ç¡¬ä»¶çš„æŸåå¹¶ä¸ä¼šå¯¼è‡´å…¨éƒ¨æ•°æ®çš„ä¸¢å¤±. 

2. é«˜ååé‡

   HDFS è®¾è®¡çš„é‡ç‚¹æ˜¯æ”¯æŒé«˜ååé‡çš„æ•°æ®è®¿é—®, è€Œä¸æ˜¯ä½å»¶è¿Ÿçš„æ•°æ®è®¿é—®. 

3. å¤§æ–‡ä»¶æ”¯æŒ

   æ–‡ä»¶å¤§å°åº”æ˜¯ GB åˆ° TB çº§åˆ«çš„. 

4. ç®€å•ä¸€è‡´æ€§æ¨¡å‹

   HDFS æ›´é€‚åˆä¸€æ¬¡å†™å…¥å¤šæ¬¡è¯»å– (write-once-read-many) çš„è®¿é—®æ¨¡å‹. **æ”¯æŒå°†å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾, ä½†ä¸æ”¯æŒæ•°æ®çš„éšæœºè®¿é—®, ä¸èƒ½ä»æ–‡ä»¶ä»»æ„ä½ç½®æ–°å¢æ•°æ®**.

5. è·¨å¹³å°ç§»æ¤æ€§

   HDFS å…·æœ‰è‰¯å¥½çš„è·¨å¹³å°ç§»æ¤æ€§, ä½¿å¾—å…¶ä»–å¤§æ•°æ®è®¡ç®—æ¡†æ¶éƒ½å°†å…¶ä½œä¸ºæ•°æ®æŒä¹…åŒ–å­˜å‚¨çš„é¦–é€‰æ–¹æ¡ˆ. 

---

> ä½œè€…:   
> URL: https://buli-home.cn/hdfs/  

