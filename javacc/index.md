# JavaCC


<!--more-->



> å› ä¸ºæœ€è¿‘çš„é¡¹ç›®é‡Œä¼šæœ‰å¤§é‡çš„ SQL ç”Ÿæˆ/è§£æ, æ‰€ä»¥å°±æ‰“ç®—è‡ªå·±å†™ä¸€ä¸ª. äºæ˜¯å°±æœ‰äº†ä»Šå¤©çš„è¿™ç¯‡ blog. 
> ä¼ é€é—¨: [JavaCC](https://javacc.github.io/javacc/)

## æ¦‚è¿°
JavaCC çš„å…¨ç§°æ˜¯ Java Compiler Compiler (æ²¡é”™å°±æ˜¯ä¿© Compiler), æ˜¯ç”¨äº Java åº”ç”¨ç¨‹åºçš„æœ€æµè¡Œçš„è§£æå™¨ç”Ÿæˆå™¨. å®ƒæ˜¯ä¸€ä¸ªå·¥å…·, ç”¨æ¥è¯»å–è¯­æ³•è§„èŒƒå¹¶å°†å…¶è½¬æ¢ä¸ºå¯ä»¥è¯†åˆ«ä¸è¯­æ³•åŒ¹é…çš„ Java ç¨‹åº. 

é™¤äº†è§£æå™¨ç”Ÿæˆå™¨æœ¬èº«ä¹‹å¤–, JavaCC å’Œæä¾›ä¸è§£æå™¨ç”Ÿæˆç›¸å…³çš„å…¶ä»–æ ‡å‡†åŠŸèƒ½, ä¾‹å¦‚æ ‘æ„å»º (é€šè¿‡ JavaCC ä¸­åŒ…å«çš„åä¸º JJTree çš„å·¥å…·, è¿™ä¸ªå·¥å…·ä¹‹åä¼šé‡ç‚¹ç”¨ä»–æ¥å®Œæˆ SQL è¯­æ³•è§£æ)ã€æ“ä½œå’Œè°ƒè¯•. 

## ç‰¹ç‚¹
* JavaCC çš„ç”Ÿæˆæ˜¯è‡ªä¸Šè€Œä¸‹ (é€’å½’ä¸‹é™) è§£æå™¨, è€Œä¸æ˜¯åƒç±»ä¼¼ YACC çš„å·¥å…·ç”Ÿæˆçš„è‡ªä¸‹è€Œä¸Šçš„è§£æå™¨. è¿™å°±å…è®¸ä½¿ç”¨æ›´é€šç”¨çš„è¯­æ³•, å°½ç®¡åšé€’å½’æ˜¯ä¸è¢«å…è®¸çš„. è‡ªä¸Šè€Œä¸‹çš„è§£æå™¨è¿˜æœ‰è®¸å¤šçš„æœ‰ç‚¹ (é™¤äº†æ›´é€šç”¨çš„è¯­æ³•ä¹‹å¤–), ä¾‹å¦‚æ›´å®¹æ˜“è°ƒè¯•, èƒ½å¤Ÿè§£æè¯­æ³•ä¸­çš„ä»»ä½•éç»ˆç«¯, ä»¥åŠèƒ½å¤Ÿå‘ä¸Šä¼ é€’å€¼ (å±æ€§) å¹¶ä¸”åœ¨è§£ææœŸé—´æ²¿ç€è§£ææ ‘å‘ä¸‹ç§»åŠ¨. 
* é»˜è®¤æƒ…å†µä¸‹, JavaCC ç”Ÿæˆä¸€ä¸ª `LL(1)` è§£æå™¨. ä½†æ˜¯, å¯èƒ½æœ‰éƒ¨åˆ†è¯­æ³•ä¸æ˜¯ `LL(1)`. JavaCC æä¾›äº†å¥æ³•å’Œè¯­ä¹‰å‰ç»çš„èƒ½åŠ›, èƒ½å¤Ÿåœ¨è¿™äº›ç‚¹ç›´æ¥è§£å†³è½®ç­æ­§ä¹‰ (shift-shift ambiguities). ğŸŒ°, è§£æå™¨ä»…åœ¨è¿™äº›ç‚¹æ˜¯ `LL(k)`, ä½†åœ¨å…¶ä»–çš„åœ°æ–¹éƒ½ä¿æŒ `LL(1)` ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½è¡¨ç°. ç§»ä½å½’çº¦ (Shift-reduce) å’Œ reduce-reduce å†²çªå¯¹äºè‡ªä¸Šè€Œä¸‹çš„è§£æå™¨æ¥è¯´ä¸æ˜¯é—®é¢˜. 
* JavaCC ç”Ÿæˆç™¾åˆ†ä¹‹ç™¾çº¯ Java çš„è§£æå™¨, å› æ­¤å¯¹ JavaCC æ²¡æœ‰è¿è¡Œæ—¶ä¾èµ–æ€§, ä¹Ÿä¸éœ€è¦åœ¨ä¸åŒæœºå™¨å¹³å°ä¸Šè¿è¡Œçš„ç‰¹æ®Šç§»æ¤å·¥ä½œ. 
* JavaCC å…è®¸åœ¨æ­¤æ³•å’Œè¯­æ³•è§„èŒƒä¸­æ‰©å±•å·´å…‹æ–¯èŒƒå¼ ([extended BNF](https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_form)), ä¾‹å¦‚ `(A)*`, `(A)+` ç­‰ç­‰. æ‰©å±•å·´å…‹æ–¯èŒƒå¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†å¯¹äºå·¦é€’å½’çš„éœ€æ±‚. å®é™…ä¸Š, æ‰©å±•å·´å…‹æ–¯èŒƒå¼é€šå¸¸æ›´å®¹æ˜“é˜…è¯», ä¾‹å¦‚ `A::=y(x)*` ä¸ `A::=Ax|y`. 
* è¯æ³•è§„èŒƒ (æ¯”å¦‚æ­£åˆ™è¡¨è¾¾å¼ã€å­—ç¬¦ä¸²) å’Œè¯­æ³•è§„èŒƒ (æ¯”å¦‚å·´å…‹æ–¯èŒƒå¼) éƒ½å†™åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­. è¿™æ ·ä½¿å¾—è¯­æ³•æ›´æ˜“è¯», å› ä¸ºå¯ä»¥åœ¨è¯­æ³•è§„èŒƒä¸­å†…è”ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼, å¹¶ä¸”ä¹Ÿæ›´æ˜“äºç»´æŠ¤. 
* JavaCC çš„è¯æ³•åˆ†æå™¨å¯ä»¥å¤„ç†å®Œæ•´çš„ Unicode è¾“å…¥, å¹¶ä¸”è¯æ³•è§„èŒƒä¹Ÿå¯ä»¥åŒ…æ‹¬ä»»ä½• Unicode å­—ç¬¦. è¿™ä¸ªç‰¹æ€§æœ‰åŠ©äºæè¿°è¯­è¨€å…ƒç´ , ä¾‹å¦‚å…è®¸æŸäº› Unicode å­—ç¬¦ (ä¸æ˜¯ ASCII ) ä½†ä¸å…è®¸å…¶ä»–å­—ç¬¦çš„ Java æ ‡è¯†ç¬¦. 
* JavaCC æä¾›äº†ç±» [Lex](https://en.wikipedia.org/wiki/Lex_(software)) çš„è¯æ³•çŠ¶æ€å’Œè¯æ³•åŠ¨ä½œåŠŸèƒ½. JavaCC ä¸­ä¼˜äºå…¶ä»–å…¬ç¥–çš„ç‰¹å®šæ–¹é¢æ˜¯ä¸€æµçŠ¶æ€, å®ƒæä¾›äº†è¯¸å¦‚ `TOKEN`, `MORE`, `SKIP` å’ŒçŠ¶æ€æ›´æ”¹ç­‰æ¦‚å¿µ. è¿™å°±å…è®¸æ›´æ¸…æ™°çš„è§„èŒƒä»¥åŠæ¥è‡ª JavaCC çš„æ›´å¥½çš„é”™è¯¯å’Œè­¦å‘Šæ¶ˆæ¯. 
* è¯æ³•è§„èŒƒä¸­é¡¶ä¸€ä¸ªä¸º*ç‰¹æ®Šæ ‡è®°*çš„æ ‡è®° (`Token`) åœ¨è§£ææœŸé—´å°†è¢«å¿½ç•¥. ä¸€ä¸ªæœ‰ç”¨çš„åº”ç”¨æ˜¯å¤„ç†è¯„è®º. 
	> æœ€åä¸€å¥è¯, æ²¡çœ‹æ˜ç™½, åŸæ–‡æ˜¯: **A useful application of this is in the processing of comments.** 
* è¯æ³•è§„èŒƒå¯ä»¥åœ¨æ•´ä¸ªè¯æ³•è§„èŒƒçš„å…¨å±€çº§åˆ«æˆ–åœ¨å•ä¸ªè¯æ³•è§„èŒƒçš„åŸºç¡€ä¸Šå®šä¹‰ä¸åŒºåˆ†å¤§å°å†™çš„æ ‡è®°. 
* JavaCC å¸¦æœ‰ JJTree, ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ ‘æ„å»ºé¢„å¤„ç†å™¨. 
* JavaCC è¿˜åŒ…æ‹¬ JJDoc, è¿™æ˜¯ä¸€ç§å°†æ„ˆå‘æ–‡ä»¶è½¬æ¢ä¸ºæ–‡æ¡£æ–‡ä»¶çš„å·¥å…·, å¯é€‰æ‹©é‡‡ç”¨ HTML æ ¼å¼. 
* JavaCC æä¾›äº†è®¸å¤šè‡ªå®šä¹‰å®ƒçš„è¡Œä¸ºå’Œç”Ÿæˆçš„è§£æå™¨çš„è¡Œä¸ºçš„é€‰é¡¹. æ­¤ç±»é€‰å‹çš„ç¤ºä¾‹æ˜¯å¯¹è¾“å…¥æµæ‰§è¡Œçš„ Unicode å¤„ç†çš„ç§ç±»ã€è¦æ‰§è¡Œçš„æ­§ä¹‰æ£€æŸ¥çš„æ ‡è®°æ•°ç­‰. 
* JavaCC çš„é”™è¯¯æŠ¥å‘Šåœ¨è§£æå™¨ç”Ÿæˆå™¨ä¸­ä¹Ÿæ˜¯å‰åˆ—çš„. JavaCC ç”Ÿæˆçš„è§£æå™¨èƒ½å¤Ÿé€šè¿‡å®Œæ•´çš„è¯Šæ–­ä¿¡æ¯æ¸…æ¥šåœ°è§£æé”™è¯¯çš„ä½ç½®. 
* é€šè¿‡ä½¿ç”¨ `DEBUG_PARSER`, `DEBUG_LOOKAHEAD` å’Œ `DEBUG_TOKEN_MANAGER` é€‰é¡¹, ç”¨æˆ·å¯ä»¥æ·±å…¥åˆ†æè§£æå’Œ token å¤„ç†æ­¥éª¤. 
* JavaCC ç‰ˆæœ¬åŒ…å«èŒƒå›´å¹¿æ³›çš„å®ä¾‹, åŒ…æ‹¬ Java å’Œ HTML è¯­æ³•. è¿™äº›å®ä¾‹åŠå…¶æ–‡æ¡£æ˜¯ç†Ÿæ‚‰ JavaCC çš„å¥½æ–¹æ³•. 

## ç¤ºä¾‹
è¿™ä¸ªç¤ºä¾‹è¯†åˆ«åŒ¹é…çš„å¤§æ‹¬å·åè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªè¡Œç»ˆæ­¢ç¬¦, ç„¶åæ˜¯æ–‡ä»¶ç»“å°¾. 

* æ­¤è¯­æ³•ä¸­åˆæ³•å­—ç¬¦ä¸²çš„ç¤ºä¾‹æ˜¯: 
	`{}`, `}}}` ç­‰ç­‰
* éæ³•å­—ç¬¦ä¸²çš„ä¾‹å­æ˜¯:
	`{}{}`, `}{}}`, `{ }`, `{x}` ç­‰ç­‰
	
### è¯­æ³•
```java
PARSER_BEGIN(Example)
/** ç®€å•å¤§æ‹¬å·åŒ¹é…å™¨ */
public class Example {
	
	/** ä¸»å…¥å£ */
	public static void main(String args[]) throws ParseException {
		Example parser = new Example(System.in);
		parser.Input();
	}

}

PARSER_END(Example)
	
/** æ ¹ç”Ÿäº§ */
void Input() : 
{}
{
	"{" [ MatchedBaraces() ] "}"
}
```

### è¾“å‡º
```terminal
$ java Example
<return>
```

```terminal
$ java Example
{x<return>
Lexical error at line 1, column 2.  Encountered: "x"
TokenMgrError: Lexical error at line 1, column 2.  Encountered: "x" (120), after : ""
        at ExampleTokenManager.getNextToken(ExampleTokenManager.java:146)
        at Example.getToken(Example.java:140)
        at Example.MatchedBraces(Example.java:51)
        at Example.Input(Example.java:10)
        at Example.main(Example.java:6)
```

```terminal
$ java Example
{}}<return>
ParseException: Encountered "}" at line 1, column 3.
Was expecting one of:
    <EOF>
    "\n" ...
    "\r" ...
        at Example.generateParseException(Example.java:184)
        at Example.jj_consume_token(Example.java:126)
        at Example.Input(Example.java:32)
        at Example.main(Example.java:6)
```


---

> ä½œè€…:   
> URL: https://buli-home.cn/javacc/  

