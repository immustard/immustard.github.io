# MySQLå‹åŠ›æµ‹è¯•


<!--more-->



## æœ‰äº†æ•°æ®åº“ä¹‹å, è¿˜éœ€è¦å…ˆè¿›è¡Œå‹æµ‹

æ‹¿åˆ°ä¸€ä¸ªæ•°æ®åº“ä¹‹å, é¦–å…ˆå¾—å…ˆå¯¹è¿™ä¸ªæ•°æ®åº“è¿›è¡Œä¸€ä¸ªè¾ƒä¸ºåŸºæœ¬çš„åŸºå‡†å‹æµ‹. ä¹Ÿå°±æ˜¯è¯´, ä½ å¾—åŸºäºä¸€äº›å·¥å…·æ¨¡æ‹Ÿä¸€ä¸ªç³»ç»Ÿæ¯ç§’å‘å‡º1000ä¸ªè¯·æ±‚åˆ°æ•°æ®åº“ä¸Šå», è§‚å¯Ÿä¸€ä¸‹ä»–çš„CPUè´Ÿè½½ã€ç£ç›˜IOè´Ÿè½½ã€ç½‘ç»œ IOè´Ÿè½½ã€å†…å­˜å¤æ‚, ç„¶åæ•°æ®åº“èƒ½å¦æ¯ç§’å¤„ç†æ‰è¿™1000ä¸ªè¯·æ±‚, è¿˜æ˜¯æ¯ç§’åªèƒ½å¤„ç†500ä¸ªè¯·æ±‚? è¿™ä¸ªè¿‡ç¨‹, å°±æ˜¯å‹æµ‹. 



é‚£ä¸ºä»€ä¹ˆä¸ç­‰åˆ°Javaç³»ç»Ÿéƒ½å¼€å‘å®Œä¹‹å, ç›´æ¥è®©Javaç³»ç»Ÿè¿æ¥ä¸ŠMySQLæ•°æ®åº“, ç„¶åç›´æ¥å¯¹Javaç³»ç»Ÿè¿›è¡Œå‹æµ‹å‘¢? 

å› ä¸ºæ•°æ®åº“çš„å‹æµ‹å’Œå®ƒä¸Šé¢çš„Javaç³»ç»Ÿçš„å‹æµ‹, å…¶å®æ˜¯ä¸¤å›äº‹, é¦–å…ˆå¾—çŸ¥é“æ•°æ®åº“æœ€å¤§èƒ½æŠ—å¤šå¤§å‹åŠ›, ç„¶åå†å»çœ‹Javaç³»ç»Ÿèƒ½æŠ—å¤šå¤§å‹åŠ›. å› ä¸ºæœ‰ä¸€ç§å¯èƒ½æ˜¯, æ•°æ®åº“æ¯ç§’å¯ä»¥æŠ—ä¸‹2000ä¸ªè¯·æ±‚, ä½†æ˜¯Javaç³»ç»Ÿæ¯ç§’åªèƒ½æŠ—ä¸‹500ä¸ªè¯·æ±‚. æ‰€ä»¥ä¸èƒ½å…‰æ˜¯å¯¹Javaç³»ç»Ÿå»è¿›è¡Œå‹æµ‹, åœ¨é‚£ä¹‹å‰ä¹Ÿå¾—å…ˆå¯¹æ•°æ®åº“è¿›è¡Œå‹æµ‹, åšåˆ°å¿ƒé‡Œæœ‰ä¸ªæ•°. 



## QPSå’ŒTPSåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«

æ—¢ç„¶æ˜¯è¦å‹æµ‹, é‚£ä¹ˆè‚¯å®šå¾—å…ˆæ˜ç™½ä¸€ç‚¹, æ¯ç§’èƒ½æŠ—ä¸‹å¤šå°‘ä¸ªè¯·æ±‚, å…¶å®æ˜¯æœ‰ä¸“ä¸šæœ¯è¯­çš„, åˆ†åˆ«æ˜¯`QPS`å’Œ`TPS`. 



- `QPS`: Query Per Second. ä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“æ¯ç§’å¯ä»¥å¤„ç†å¤šå°‘ä¸ªè¯·æ±‚, å¤§è‡´å¯ä»¥ç†è§£ä¸ºä¸€æ¬¡è¯·æ±‚å°±æ˜¯ä¸€æ¡SQLè¯­å¥, ä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“å¯ä»¥æ¯ç§’å¤„ç†å¤šå°‘ä¸ªSQLè¯­å¥. 

Javaç³»ç»Ÿæˆ–è€…ä¸­é—´ä»¶ç³»ç»Ÿåœ¨è¿›è¡Œå‹æµ‹çš„æ—¶å€™, ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªæŒ‡æ ‡. 

- `TPS`: Transaction Per Second. æŒ‡çš„æ˜¯æ¯ç§’å¯ä»¥å¤„ç†çš„äº‹åŠ¡é‡. å°±æ˜¯è¯´æ•°æ®åº“å¯ä»¥æ¯ç§’å¤„ç†å¤šå°‘æ¬¡äº‹åŠ¡æäº¤æˆ–è€…å›æ»š. 



## IOç›¸å…³çš„å‹æµ‹æ€§èƒ½æŒ‡æ ‡

1. `IOPS`: æŒ‡çš„æ˜¯æœºå™¨çš„éšæœºIOå¹¶å‘å¤„ç†èƒ½åŠ›. ä¸¾ä¸ªğŸŒ°: æœºå™¨å¯ä»¥è¾¾åˆ°200 IOPS, æ„æ€å°±æ˜¯è¯´æ¯ç§’å¯ä»¥æ‰§è¡Œ200ä¸ªéšæœºIOè¯»å†™è¯·æ±‚. 

    è¿™ä¸ªæŒ‡æ ‡å¾ˆå…³é”®, å› ä¸ºåœ¨ä¹‹å‰è¯´è¿‡, åœ¨å†…å­˜ä¸­æ›´æ–°çš„è„æ•°æ®åº“, æœ€åéƒ½ç”±åå°IOçº¿ç¨‹åœ¨ä¸ç¡®å®šçš„æ—¶é—´, åˆ·å›åˆ°ç£ç›˜ä¸­å», è¿™å°±æ˜¯éšæœºIOçš„è¿‡ç¨‹. ä¹Ÿå°±æ˜¯è¯´, å¦‚æœIOPSæŒ‡æ ‡å¤ªä½, é‚£ä¹ˆå°±ä¼šå¯¼è‡´å†…å­˜é‡Œçš„è„æ•°æ®åº“åˆ·å›ç£ç›˜çš„æ•ˆç‡ä¸é«˜. 

2. **ååé‡**: æŒ‡çš„æ˜¯æœºå™¨çš„ç£ç›˜å­˜å‚¨æ¯ç§’å¯ä»¥è¯»å†™å¤šå°‘å­—èŠ‚çš„æ•°æ®é‡. 

    è¿™ä¸ªæŒ‡æ ‡ä¹Ÿå¾ˆå…³é”®, ä¹‹å‰ä¹Ÿè¯´è¿‡, åœ¨æ‰§è¡Œå„ç§SQLè¯­å¥çš„æ—¶å€™, æäº¤äº‹åŠ¡çš„æ—¶å€™, å…¶å®éƒ½æ˜¯å¤§é‡çš„ä¼šå†™redo logä¹‹ç±»çš„æ—¥å¿—çš„, è¿™äº›æ—¥å¿—éƒ½ä¼šç›´æ¥å†™ç£ç›˜æ–‡ä»¶. æ‰€ä»¥ä¸€å°æœºå™¨çš„å­˜å‚¨æ¯ç§’å¯ä»¥è¯»å†™å¤šå°‘å­—èŠ‚çš„æ•°æ®é‡, å°±å†³å®šäº†ä»–æ¯ç§’å¯ä»¥æŠŠå¤šå°‘redo logä¹‹ç±»çš„æ—¥å¿—å†™å…¥åˆ°ç£ç›˜é‡Œå». 

    ä¸€èˆ¬æ¥è¯´, æˆ‘ä»¬å†™redo logä¹‹ç±»çš„æ—¥å¿—, éƒ½æ˜¯å¯¹ç£ç›˜æ–‡ä»¶è¿›è¡Œé¡ºåºå†™å…¥çš„, ä¹Ÿå°±æ˜¯ä¸€è¡Œæ¥ç€ä¸€è¡Œçš„å†™, ä¸ä¼šè¯´è¿›è¡Œéšæœºçš„è¯»å†™, é‚£ä¹ˆä¸€èˆ¬æ™®é€šç£ç›˜çš„é¡ºåºå†™å…¥çš„ååé‡æ¯ç§’éƒ½å¯ä»¥è¾¾åˆ°200MBå·¦å³. 

    æ‰€ä»¥é€šå¸¸è€Œè¨€, æœºå™¨çš„ç£ç›˜ååé‡éƒ½æ˜¯è¶³å¤Ÿæ‰¿è½½é«˜å¹¶å‘è¯·æ±‚çš„. 

3. `latency`: æŒ‡çš„æ˜¯å¾€ç£ç›˜é‡Œå†™å…¥ä¸€æ¡æ•°æ®çš„å»¶è¿Ÿ.

    è¿™ä¸ªæŒ‡æ ‡åŒæ ·é‡è¦, å› ä¸ºæ‰§è¡ŒSQLè¯­å¥çš„å’Œæäº¤äº‹åŠ¡çš„æ—¶å€™, éƒ½éœ€è¦é¡ºåºå†™redo logç£ç›˜æ–‡ä»¶, æ‰€ä»¥æ­¤æ—¶å†™ä¸€æ¡æ—¥å¿—åˆ°ç£ç›˜æ–‡ä»¶é‡Œå», åˆ°åº•æ˜¯å»¶è¿Ÿ1ms, è¿˜æ˜¯å»¶è¿Ÿ100us, è¿™å°±å¯¹æ•°æ®åº“çš„SQLè¯­å¥æ‰§è¡Œæ€§èƒ½æ˜¯æœ‰å½±å“çš„. 



## å‹æµ‹çš„æ—¶å€™è¦å…³æ³¨çš„å…¶ä»–æ€§èƒ½æŒ‡æ ‡

1. **CPUè´Ÿè½½**: è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æŒ‡æ ‡. å› ä¸ºå‡è®¾æ•°æ®åº“å‹æµ‹åˆ°äº†3000 QPS, å¯èƒ½å…¶ä»–æŒ‡æ ‡éƒ½è¿˜æ­£å¸¸, ä½†æ˜¯æ­¤æ—¶CPUè´Ÿè½½ç‰¹åˆ«é«˜, é‚£ä¹ˆä¹Ÿè¯´æ˜ä½ çš„æ•°æ®åº“ä¸èƒ½ç»§ç»­å¾€ä¸‹å‹æµ‹æ›´é«˜çš„QPSäº†, å¦åˆ™CPUæ˜¯åƒä¸æ¶ˆçš„. 

2. **ç½‘ç»œè´Ÿè½½**: è¿™ä¸ªå°±æ˜¯çœ‹æœºå™¨å¸¦å®½æƒ…å†µä¸‹, åœ¨å‹æµ‹åˆ°ä¸€å®šçš„QPSå’ŒTPSçš„æ—¶å€™, æ¯ç§’é’Ÿæœºå™¨çš„ç½‘å¡ä¼šè¾“å…¥å¤šå°‘MBæ•°æ®, ä¼šè¾“å‡ºå¤šå°‘MBæ•°æ®. å› ä¸ºæœ‰å¯èƒ½ç½‘ç»œå¸¦å®½æœ€å¤šæ¯ç§’ä¼ è¾“100MBçš„æ•°æ®, é‚£ä¹ˆå¯èƒ½QPSåˆ°1000çš„æ—¶å€™, ç½‘å¡å°±æ‰“æ»¡äº†, å·²ç»æ¯ç§’ä¼ è¾“100MBçš„æ•°æ®äº†, æ­¤æ—¶å³ä½¿å…¶ä»–æŒ‡æ ‡è¿˜æ­£å¸¸, ä¹Ÿä¸èƒ½ç»§ç»­å‹æµ‹ä¸‹å»äº†. 

3. **å†…å­˜è´Ÿè½½**: è¿™ä¸ªå°±æ˜¯çœ‹å‹æµ‹åˆ°ä¸€å®šæƒ…å†µä¸‹çš„æ—¶å€™, æœºå™¨å†…å­˜æŸè€—äº†å¤šå°‘, å¦‚æœè¯´æœºå™¨å†…å­˜æŸè€—è¿‡é«˜äº†, è¯´æ˜ä¹Ÿä¸èƒ½ç»§ç»­å‹æµ‹ä¸‹å»äº†. 



## æ¨èå‹æµ‹å·¥å…·

`sysbench`, è¿™ä¸ªå·¥å…·å¯ä»¥è‡ªåŠ¨å¸®ä½ åœ¨æ•°æ®åº“é‡Œæ„å»ºå‡ºæ¥å¤§é‡çš„æ•°æ®. ç„¶åä¹Ÿå¯ä»¥æ¨¡æ‹Ÿå‡ åƒä¸ªçº¿ç¨‹å¹¶å‘çš„è®¿é—®æ•°æ®åº“, æ¨¡æ‹Ÿå„ç§sqlè¯­å¥, åŒ…æ‹¬å„ç§ä¹¦å±‹æäº¤åˆ°æ•°æ®åº“é‡Œ, ç”šè‡³å¯ä»¥æ¨¡æ‹Ÿå‡ºå‡ åä¸‡çš„TPSå¯¹æ•°æ®åº“è¿›è¡Œå‹æµ‹. 


---

> ä½œè€…:   
> URL: https://buli-home.cn/mysql_4/  

